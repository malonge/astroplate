---
import ImageMod from "@/components/ImageMod.astro";
import Base from "@/layouts/Base.astro";
import { markdownify } from "@/lib/utils/textConverter";
import type { CollectionEntry } from "astro:content";
import { getEntry } from "astro:content";
import { FiDatabase, FiGlobe, FiZap, FiBookOpen } from "react-icons/fi";


interface Homepage {
  banner: {
    name: string;
    title: string;
    tagline: string;
    image: string;
    button: {
      enable: boolean;
      label: string;
      link: string;
    };
  };
  projects: {
    title: string;
    description: string;
    items: Array<{
      title: string;
      description: string;
      icon: string;
      links: Array<{
        label: string;
        url: string;
      }>;
    }>;
  };
  publications: {
    title: string;
    description: string;
    items: Array<{
      title: string;
      description: string;
      journal: string;
      year: string;
      icon: string;
      links: Array<{
        label: string;
        url: string;
      }>;
    }>;
  };
  cta: {
    title: string;
    description: string;
    links: Array<{
      label: string;
      url: string;
    }>;
  };
}

const homepage = (await getEntry(
  "homepage",
  "-index"
)) as CollectionEntry<"homepage">;

const { banner, projects, publications, cta } = homepage.data as Homepage;
---

<Base>
  <!-- Banner -->
  <section class="section pt-14">
    <div class="container">
      <div class="row items-center justify-between">
        <div class="md:col-4">
          {
            banner.image && (
              <div class="flex justify-center mb-12">
                <ImageMod
                  src={banner.image}
                  height={280}
                  width={280}
                  alt="banner"
                  format="webp"
                />
              </div>
            )
          }
        </div>
        <div class="md:col-8">
          <div class="text-center md:text-left">
            <h1
              set:html={markdownify(banner.name)}
              class="mb-4 text-h3 lg:text-h1"
            />
            <h2
              set:html={markdownify(banner.title)}
              class="mb-4 text-h4 lg:text-h3"
            />
            <p set:html={markdownify(banner.tagline)} class="mb-8 text-lg" />
            {banner.button.enable && (
              <a href={banner.button.link} class="btn btn-outline-primary">
                {banner.button.label}
              </a>
            )}
          
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- /Banner -->

  <!-- Projects Section -->
  <section class="section-sm bg-gradient">
    <div class="container">
              <div class="row justify-center text-center">
          <div class="lg:col-8 md:col-10">
            <h2 class="mb-20 text-h3 lg:text-h2">{projects.title}</h2>
          </div>
        </div>
      <div class="row">
        {projects.items.map((project, index: number) => (
          <div class="md:col-4 mb-8 px-12">
            <div class="text-start group">
              <!-- Icon -->
              <div class="mb-6">
                <div class="flex h-16 w-16 items-center justify-center rounded-full bg-light text-text">
                  <span class="text-2xl">
                    {project.icon === "database" && <FiDatabase className="h-7 w-7" />}
                    {project.icon === "chart" && <FiGlobe className="h-7 w-7" />}
                    {project.icon === "brain" && <FiZap className="h-7 w-7" />}
                  </span>
                </div>
              </div>
              <!-- Title -->
              <a href={project.links[0].url}><h3 class="mb-4 text-xl font-bold">{project.title}</h3></a>
              <!-- Description -->
              <p class="mb-6 text-muted">{project.description}</p>
              <!-- Links -->
              <div class="flex flex-col gap-2">
                {project.links.map((link) => (
                  <a
                    href={link.url}
                    class="text-sm hover:underline transition-colors"
                  >
                    {link.label} →
                  </a>
                ))}
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>
  <!-- /Projects Section -->

  <!-- Publications Section -->
  <section class="section-sm">
    <div class="container">
              <div class="row justify-center text-center">
          <div class="lg:col-8 md:col-10">
            <h2 class="mb-20 text-h3 lg:text-h2">{publications.title}</h2>
          </div>
        </div>
      <div class="row">
        {publications.items.map((publication, index: number) => (
          <div class="md:col-4 mb-8 px-12">
            <div class="text-start group">
              <!-- Icon -->
              <div class="mb-6">
                <div class="flex h-16 w-16 items-center justify-center rounded-full bg-light text-text">
                  <span class="text-2xl">
                    {publication.icon === "dna" && <FiBookOpen className="h-7 w-7" />}
                    {publication.icon === "microscope" && <FiBookOpen className="h-7 w-7" />}
                    {publication.icon === "cloud" && <FiBookOpen className="h-7 w-7" />}
                  </span>
                </div>
              </div>
              <!-- Title -->
              <a href={publication.links[0].url}><h3 class="mb-3 text-xl font-bold">{publication.title}</h3></a>
              <!-- Journal & Year -->
              <p class="mb-4 text-sm text-muted">
                {publication.journal}, {publication.year}
              </p>
              <!-- Description -->
              <p class="mb-6 text-muted">{publication.description}</p>
              <!-- Links -->
              <div class="flex flex-col gap-2">
                {publication.links.map((link) => (
                  <a
                    href={link.url}
                    class="text-sm hover:underline transition-colors"
                  >
                    {link.label} →
                  </a>
                ))}
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>
  <!-- /Publications Section -->

  <!-- Call to Action Section -->
  <section class="section-sm bg-gradient">
    <div class="container">
      <div class="row justify-center text-center">
        <div class="lg:col-8 md:col-10">
          <h2 class="mb-4 text-h3 lg:text-h2">{cta.title}</h2>
          <p class="mb-8 text-lg">{cta.description}</p>
          <div class="flex flex-wrap justify-center gap-4">
            {cta.links.map((link) => (
              <a
                href={link.url}
                class="btn btn-outline-primary"
              >
                {link.label}
              </a>
              ))}
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- /Call to Action Section -->

</Base>
